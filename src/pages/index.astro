---
import NavBar from "../components/nav/NavBar.astro";
import HomepageCard from "../components/HomepageCard.astro";
import Layout from "../layouts/Layout.astro";
---

<Layout title="Adapt" hideNavBar>
  <main class="m-auto">
    <!-- Banner -->
    <div
      class="flex flex-col relative overflow-hidden box-border h-full"
      id="banner"
    >
      <NavBar transparent />
      <canvas id="mesh-gradient" data-transition-in></canvas>
      <div
        class="motion-safe:animate-fade-in text-center flex flex-col items-center px-24 py-32 mobile:px-12 mobile:py-16"
      >
        <h1 class="text-8xl mobile-xs:text-7xl font-black pb-8 font-title">
          Adapt, Evolve, Chat
        </h1>
        <p class="text-xl text-white text-opacity-60">
          Grow a community, connect with your friends, or whatever you're
          capable of with Adapt, a lightweight and customizable messaging
          platform which favors your privacy.
        </p>
        <div class="flex gap-4 mt-12 mobile:flex-col">
          <a class="btn btn-secondary btn-lg" href="#why-adapt">Learn More</a>
          <a class="btn btn-primary btn-lg" href="https://app.adapt.chat"
            >Launch Adapt</a
          >
        </div>
      </div>
    </div>

    <!-- Why Adapt -->
    <h2
      class="text-center p-8 mt-4 text-4xl font-bold font-title"
      id="why-adapt"
    >
      Why Adapt?
    </h2>
    <div class="flex justify-center">
      <ul
        class="flex flex-wrap m-auto justify-between max-w-[2000px] md:mx-4 mobile:flex-nowrap mobile:flex-col"
      >
        <HomepageCard title="Open Source" icon="/icons/code.svg">
          Adapt is completely open source, so you can see exactly what's going
          on under the hood. It also means you, along with the community, can
          contribute to Adapt. This means adding features, patching bugs, and
          detecting security vulnerabilities is faster and easier.
        </HomepageCard>
        <HomepageCard title="Privacy" icon="/icons/lock.svg">
          Adapt values your privacy. We store as little data as possible, and we
          don't sell your data to advertisers. If you're ever in doubt, remember
          that Adapt is open source.
        </HomepageCard>
        <HomepageCard title="Fast" icon="/icons/bolt.svg">
          Adapt's backends are written in <i>Rust</i>, not only ensuring that
          Adapt is performant, but also preventing less error-prone and
          vulnerable code from being shipped. And your client can be written in
          Rust too, if you want.
        </HomepageCard>
      </ul>
    </div>

    <!-- Launch + Download -->
    <div class="flex flex-col items-center pt-24 pb-16">
      <h2 class="text-center text-3xl font-bold font-title" id="launch">
        Let's get started.
      </h2>

      <div class="flex flex-col gap-2 mt-8 items-center">
        <!-- Launch Button -->
        <div class="relative group">
          <div
            class="px-8 py-4 absolute btn btn-lg text-xl font-bold rounded-lg blur group-hover:blur-lg
              will-change-[filter] bg-gradient-to-r from-primary to-secondary inset-0 font-title"
          >
            Launch Adapt
          </div>
          <a
            class="p-0.5 relative btn btn-lg border-none inline-flex items-center justify-center font-bold overflow-hidden rounded-lg"
            href="//app.adapt.chat"
          >
            <span
              class="w-full h-full bg-gradient-to-br from-primary to-secondary absolute"
            ></span>
            <span
              class="relative flex items-center justify-center w-full h-full px-8 py-4 transition-all ease-out
              bg-gray-900 rounded-md group-hover:bg-opacity-0 duration-400"
            >
              <span
                class="relative bg-gradient-to-r from-primary-400 to-secondary-400 bg-clip-text text-transparent
                  group-hover:from-primary-100 group-hover:to-secondary-100 text-xl mobile-xs:text-lg font-title"
              >
                Launch Adapt
              </span>
            </span>
          </a>
        </div>

        <!-- Small Download Text -->
        <!-- Download Button -->
        <button
          class="mt-2 inline-flex items-center gap-2 px-4 py-2 text-sm font-semibold
         text-white bg-gradient-to-r from-primary-500 to-primary-400
         rounded-full shadow-md backdrop-blur-sm
         hover:from-primary-400 hover:to-primary-300
         transition-all duration-200"
          onClick={() =>
            document
              .getElementById("download-modal")!
              .classList.remove("hidden")}
        >
          <!-- Download Icon -->
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="w-4 h-4"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 16v2a2 2 0 002 2h12a2 2 0 002-2v-2M7 10l5 5m0 0l5-5m-5 5V4"
            ></path>
          </svg>
          Download
        </button>
      </div>
    </div>

    <!-- Download Modal -->
    <div
      id="download-modal"
      class="fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center hidden z-50"
    >
      <div
        id="download-modal-inner"
        class="bg-gray-900 text-white rounded-2xl w-full max-w-xl p-8 relative transform scale-95 opacity-0 transition-all duration-300 ease-out shadow-2xl"
      >
        <!-- Close button -->
        <button
          class="absolute top-4 right-4 text-white hover:text-gray-300 font-bold text-2xl"
          onClick={() => closeDownloadModal()}
        >
          Ã—
        </button>

        <!-- Header -->
        <h2 class="text-3xl font-bold mb-6 text-center font-title">
          Download Adapt
        </h2>
        <p class="text-center text-gray-400 mb-6">
          Choose your platform to download the latest desktop build of Adapt.
        </p>

        <!-- Platform Cards -->
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
          <!-- Windows -->
          <div
            class="bg-gray-800 rounded-xl p-4 flex flex-col gap-3 hover:bg-gray-700 transition"
          >
            <div class="flex items-center gap-2">
              <img
                src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5f/Windows_logo_-_2012.svg/1024px-Windows_logo_-_2012.svg.png"
                class="w-6 h-6"
                alt="Windows Icon"
              />
              <h3 class="font-semibold text-lg">Windows</h3>
            </div>
            <ul class="list-disc list-inside ml-5 text-sm text-gray-300">
              <li>
                <a
                  class="text-primary-400 hover:underline"
                  href="https://download.adapt.chat/webclient/windows-x86_64/Adapt-setup.exe"
                  >x86_64 (64 bit)</a
                >
              </li>
              <li>
                <a
                  class="text-primary-400 hover:underline"
                  href="https://download.adapt.chat/webclient/windows-i686/Adapt-setup.exe"
                  >i686 (32 bit)</a
                >
              </li>
            </ul>
          </div>

          <!-- MacOS -->
          <div
            class="bg-gray-800 rounded-xl p-4 flex flex-col gap-3 hover:bg-gray-700 transition"
          >
            <div class="flex items-center gap-2">
              <img
                src="https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_logo_black.svg"
                class="w-6 h-6"
                alt="Mac Icon"
              />
              <h3 class="font-semibold text-lg">MacOS</h3>
            </div>
            <ul
              class="list-disc list-inside ml-5 text-sm text-gray-300 space-y-1"
            >
              <li>
                Intel x86_64:
                <a
                  class="text-primary-400 hover:underline"
                  href="https://download.adapt.chat/webclient/darwin-x86_64/Adapt.app.zip"
                  >.app bundle</a
                > |
                <a
                  class="text-primary-400 hover:underline"
                  href="https://download.adapt.chat/webclient/darwin-x86_64/Adapt-installer.dmg"
                  >.dmg installer</a
                >
              </li>
              <li>
                Apple Silicon aarch64:
                <a
                  class="text-primary-400 hover:underline"
                  href="https://download.adapt.chat/webclient/darwin-aarch64/Adapt.app.zip"
                  >.app bundle</a
                > |
                <a
                  class="text-primary-400 hover:underline"
                  href="https://download.adapt.chat/webclient/darwin-aarch64/Adapt-installer.dmg"
                  >.dmg installer</a
                >
              </li>
            </ul>
          </div>

          <!-- Linux -->
          <div
            class="bg-gray-800 rounded-xl p-4 flex flex-col gap-3 hover:bg-gray-700 transition sm:col-span-2"
          >
            <div class="flex items-center gap-2">
              <img
                src="https://upload.wikimedia.org/wikipedia/commons/a/af/Tux.png"
                class="w-6 h-6"
                alt="Linux Icon"
              />
              <h3 class="font-semibold text-lg">Linux</h3>
            </div>
            <ul class="list-disc list-inside ml-5 text-sm text-gray-300">
              <li>
                <a
                  class="text-primary-400 hover:underline"
                  href="https://download.adapt.chat/webclient/linux-x86_64/Adapt.deb"
                  >.deb</a
                >
              </li>
              <li>
                <a
                  class="text-primary-400 hover:underline"
                  href="https://download.adapt.chat/webclient/linux-x86_64/Adapt.AppImage"
                  >AppImage</a
                >
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <script>
      import { Gradient } from "whatamesh";

      const gradient = new Gradient();
      gradient.initGradient("#mesh-gradient");

      const banner = document.getElementById("banner")!;
      banner.addEventListener("mouseover", () => gradient.play());
      banner.addEventListener("mouseout", () => gradient.pause());

      const modal = document.getElementById("download-modal")!;
      const modalInner = document.getElementById("download-modal-inner")!;
      const downloadButton = document.querySelector("button[onClick]")!;

      function openDownloadModal() {
        modal.classList.remove("hidden");
        requestAnimationFrame(() => {
          modalInner.classList.remove("scale-95", "opacity-0");
          modalInner.classList.add("scale-100", "opacity-100");
        });
      }

      function closeDownloadModal() {
        modalInner.classList.remove("scale-100", "opacity-100");
        modalInner.classList.add("scale-95", "opacity-0");
        setTimeout(() => modal.classList.add("hidden"), 300);
      }

      downloadButton.addEventListener("click", openDownloadModal);
      modal.addEventListener("click", (e) => {
        if (e.target === modal) closeDownloadModal();
      });
      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape" && !modal.classList.contains("hidden"))
          closeDownloadModal();
      });
    </script>

    <style>
      #mesh-gradient {
        top: 0;
        left: 0;
        display: flex;
        position: absolute;
        align-items: stretch;
        justify-content: stretch;
        width: 100%;
        height: 100%;
        opacity: 0.5;
        flex-grow: 1;
        z-index: -1;
        --gradient-color-1: #0586ff;
        --gradient-color-2: #9500f2;
        --gradient-color-3: #ff3d94;
        --gradient-color-4: #0056c6;
      }

      #download-modal-inner {
        transition: all 0.3s ease-out;
      }
    </style>
  </main></Layout
>
